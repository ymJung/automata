# 주식 매매 프로그램

이 프로젝트는 한국투자증권 API를 활용하여 특정 전략에 따라 주식을 자동으로 매매하는 프로그램입니다.

## 주요 기능

- 이동평균선, RSI, EWO 등 다양한 기술적 지표를 활용한 매매 시점 포착
- DCA(분할 매수) 전략을 통한 리스크 관리
- 설정 파일을 통한 유연한 API 키 및 계좌 정보 관리

## 환경 설정

### 1. 필요 라이브러리 설치

이 프로그램을 실행하기 위해서는 다음 라이브러리를 설치해야 합니다.

```bash
pip install pykoreainvestment
```

### 2. API 키 및 계좌 설정

1.  `config.cfg.sample` 파일을 `config.cfg` 파일로 복사합니다.
2.  `config.cfg` 파일을 열어 본인의 한국투자증권 API 키와 계좌번호를 입력합니다.

    ```cfg
    [kis]
    APP_KEY = "여기에_발급받은_APP_KEY를_입력하세요"
    APP_SECRET = "여기에_발급받은_APP_SECRET을_입력하세요"
    ACCOUNT_NO = "계좌번호_앞8자리-뒤2자리_형태로_입력"
    ```

    **주의:** `config.cfg` 파일은 개인의 민감한 정보를 담고 있으므로, `.gitignore`에 추가하여 Git 저장소에 올라가지 않도록 주의해야 합니다.

## 매매 전략

이 문서는 주식 매매 프로그램의 핵심 전략을 정의합니다. 본 전략은 특정 지표들을 활용하여 매수 및 매도 시점을 결정하며, DCA(Dollar-Cost Averaging) 방식을 통해 리스크를 관리합니다.

### 1. 사용 지표

- **이동평균선 (EMA)**
  - **단기 EMA**: 5일 이동평균선
  - **장기 EMA**: 35일 이동평균선
- **RSI (Relative Strength Index)**: 14일 기준을 사용하여 시장의 과매수/과매도 상태를 판단합니다.
- **EWO (Elder's Wave Oscillator)**: 단기 EMA와 장기 EMA의 차이를 백분율로 계산합니다.
  - **기준치**: 과매수 신호는 `5`, 과매도 신호는 `−5`로 설정합니다.
    - `EWO ≥ 5`: 과매수 신호로 간주합니다.
    - `EWO ≤ −5`: 과매도 신호로 간주합니다.
- **데이터 누락 여부**: 1일 (5분봉 데이터 576개) 동안의 데이터 누락 여부를 확인하여 신뢰성 있는 분석을 위한 필수 조건으로 사용합니다.

### 2. 매수 조건

다음 두 가지 조건 중 하나라도 충족되면 매수 포지션을 고려합니다.

1.  **현재 가격이 단기 EMA 값 이하일 때**
    - `현재 가격 ≤ 단기 EMA 값`
    - **Low Offset 파라미터**: `-0.9`에서 `0.99` 사이의 값을 단기 EMA 값에 곱하여 기준치로 사용합니다.
    - EWO가 설정된 기준치 이상 (예: `5`, 과매수 신호)이어야 합니다.
    - RSI가 기준치 이하여야 합니다.
    - 데이터 누락이 없어야 합니다.

2.  **현재 가격이 (단기 EMA 값 * Low Offset)보다 낮을 때**
    - `현재 가격 < 단기 EMA 값 * Low Offset`
    - EWO가 설정된 기준치 이하 (예: `−5`, 과매도 신호)여야 합니다.
    - 데이터 누락이 없어야 합니다.

### 3. 주문 체결 방식

- **DCA (Dollar-Cost Averaging) 방식**: 분할 매수 전략을 채택하여 평균 매수 단가를 낮춥니다.
- **주문 분할**: 초기 주문 후 가격이 하락할 시 추가 매수를 진행합니다.
  - 기본적으로 3분할 주문 방식을 채택합니다.
  - 향후 5분할 전환도 고려 중입니다.

### 4. 매도 조건

다음 조건 중 하나라도 충족되면 매도 포지션을 고려합니다.

- **단기 EMA가 기준치 이상이고 거래량이 기준치 이상일 때**
  - `단기 EMA ≥ 기준치`
  - **High Offset**: 특정 종목에는 다른 값을 적용할 수 있습니다.
  - `거래량 ≥ 기준치`
- **손절매 (Stop Loss)**: 매수 가격 대비 `−35%` 하락 시 자동으로 손절매합니다.

---
*이 전략은 지속적인 검토와 시장 상황에 따른 최적화가 필요합니다.*
